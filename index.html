<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Multi</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Chakra Petch font -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;700&display=swap" rel="stylesheet">

  <!-- React / ReactDOM / Framer Motion (UMD) -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.umd.js"></script>

  <!-- Babel for inline JSX (tell it which presets!) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    :root { --bg:#000; --fg:#fff; --ring:rgba(255,255,255,.12); --tile:rgba(255,255,255,.05); }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body { margin:0; background:var(--bg); color:var(--fg); font-family:"Chakra Petch",system-ui,-apple-system,"Segoe UI",Roboto,sans-serif; overflow:hidden; }
    .root { position:relative; min-height:100vh; width:100%; overflow:hidden; background:#000; }

    .scanlines { pointer-events:none; position:absolute; inset:0; opacity:.30; mix-blend-mode:screen;
      background-image:repeating-linear-gradient(0deg, rgba(255,255,255,.035) 0px, rgba(255,255,255,.035) 1px, transparent 1px, transparent 3px); }
    .vignette { pointer-events:none; position:absolute; inset:0; opacity:.2;
      background:radial-gradient(1200px 600px at 50% 50%, rgba(255,255,255,.08), transparent 70%); }

    .title { position:absolute; left:24px; top:24px; z-index:30; font-weight:700; letter-spacing:-.02em; font-size:clamp(2rem,5vw,3.5rem); user-select:none; }

    .bubble { position:absolute; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.35); border:1px solid rgba(255,255,255,.08);
      overflow:hidden; transition:transform 200ms ease, outline-color 200ms ease; outline:0px solid transparent; cursor:pointer; will-change:transform; backdrop-filter:blur(2px); }
    .bubble:hover { transform:scale(1.04); outline:2px solid var(--ring); }
    .bubble-inner { height:100%; width:100%; background-image:repeating-linear-gradient(180deg, rgba(255,255,255,.06) 0 1px, transparent 1px 3px); position:relative; }
    .bubble-shimmer { position:absolute; left:0; right:0; bottom:0; height:24px; opacity:0; transition:opacity 180ms ease;
      background:linear-gradient(90deg, transparent, rgba(255,255,255,.25), transparent);
      -webkit-mask-image:linear-gradient(180deg, transparent, black 30%, black); mask-image:linear-gradient(180deg, transparent, black 30%, black); }
    .bubble:hover .bubble-shimmer { opacity:1; }
    .bubble-icons { position:absolute; right:8px; top:8px; display:flex; gap:6px; opacity:.8; }
    .bubble-icon { background:rgba(0,0,0,.3); padding:4px; border-radius:999px; border:1px solid rgba(255,255,255,.15); transition:background 150ms ease; }
    .bubble:hover .bubble-icon { background:rgba(0,0,0,.4); }
    .fake-input { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); opacity:0; transition:opacity 180ms ease; }
    .fake-pill { display:flex; align-items:center; gap:8px; border-radius:999px; background:rgba(0,0,0,.4); padding:6px 10px; border:1px solid rgba(255,255,255,.15); backdrop-filter:blur(3px); }
    .fake-caret { display:inline-block; width:1px; height:16px; background:rgba(255,255,255,.85); animation:pulse 1s infinite; }
    .bubble:hover .fake-input { opacity:1; }
    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.2} }

    .dot { pointer-events:none; position:absolute; z-index:20; width:12px; height:12px; border-radius:999px; background:white; box-shadow:0 0 16px 6px rgba(255,255,255,.5); transform:translate(-50%,-50%); }

    .controls { position:fixed; left:24px; bottom:24px; z-index:40; display:flex; gap:12px; }
    .btn { border-radius:16px; padding:10px; background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.1); box-shadow:0 6px 20px rgba(0,0,0,.35); backdrop-filter:blur(4px); transition:background 150ms ease, transform 80ms ease; }
    .btn:hover { background:rgba(255,255,255,.1); }
    .btn:active { transform:scale(.96); }

    .hint { position:absolute; right:24px; top:24px; z-index:30; display:flex; gap:8px; align-items:center; }
    .hint .ping { width:8px; height:8px; border-radius:999px; background:rgba(255,255,255,.7); animation:ping 1.1s infinite; }
    .hint .dot2 { width:8px; height:8px; border-radius:999px; background:rgba(255,255,255,.5); }
    @keyframes ping { 0%{transform:scale(1); opacity:.8} 70%{transform:scale(2.3); opacity:0} 100%{opacity:0} }

    .baseline { pointer-events:none; position:fixed; left:0; right:0; bottom:0; z-index:0; height:2px; background:linear-gradient(90deg, transparent, rgba(255,255,255,.45), transparent); opacity:.35; animation:breathe 8s infinite ease-in-out; }
    @keyframes breathe { 0%{opacity:.35} 20%{opacity:.15} 40%{opacity:.3} 60%{opacity:.18} 100%{opacity:.35} }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- NOTE the data-presets attribute -->
  <script type="text/babel" data-presets="env,react">
    const { useEffect, useMemo, useRef, useState } = React;
    const { motion, AnimatePresence } = window["framer-motion"];

    function MultiLanding() {
      const [spotlightOn, setSpotlightOn] = useState(true);
      const [cursor, setCursor] = useState({ x: 0, y: 0 });

      const ballRef = useRef({ x: 200, y: 200, vx: 2.3, vy: 1.7 });
      const ballEl = useRef(null);

      const [channelCount, setChannelCount] = useState(window.innerWidth < 640 ? 8 : 12);
      useEffect(() => {
        const onResize = () => setChannelCount(window.innerWidth < 640 ? 8 : 12);
        window.addEventListener("resize", onResize);
        return () => window.removeEventListener("resize", onResize);
      }, []);

      const channels = useMemo(() =>
        Array.from({ length: channelCount }).map((_, i) => ({
          id: i,
          w: 96 + ((i * 37) % 72),
          hRatio: 0.66,
          delay: (i * 0.15) % 1.2,
          hue: (i * 29) % 360,
          leftPct: (i * 8.3) % 90,
          topPct: (i * 11.7) % 80,
          speed: 11 + (i % 7),
        })), [channelCount]);

      useEffect(() => {
        let raf;
        const step = () => {
          const W = window.innerWidth;
          const H = window.innerHeight;
          const b = ballRef.current;
          b.x += b.vx; b.y += b.vy;
          if (b.x < 20 || b.x > W - 20) b.vx *= -1;
          if (b.y < 20 || b.y > H - 20) b.vy *= -1;
          b.vx += (Math.random() - 0.5) * 0.02;
          b.vy += (Math.random() - 0.5) * 0.02;
          const cap = 3.0;
          b.vx = Math.max(Math.min(b.vx, cap), -cap);
          b.vy = Math.max(Math.min(b.vy, cap), -cap);
          if (ballEl.current) {
            ballEl.current.style.transform = `translate(${b.x}px, ${b.y}px)`;
          }
          raf = requestAnimationFrame(step);
        };
        if (ballEl.current) {
          const b = ballRef.current;
          ballEl.current.style.transform = `translate(${b.x}px, ${b.y}px)`;
        }
        raf = requestAnimationFrame(step);
        return () => cancelAnimationFrame(raf);
      }, []);

      useEffect(() => {
        const onMove = (e) => setCursor({ x: e.clientX, y: e.clientY });
        window.addEventListener("mousemove", onMove);
        return () => window.removeEventListener("mousemove", onMove);
      }, []);

      useEffect(() => {
        const onKey = (e) => {
          if (e.code === "Space") { e.preventDefault(); setSpotlightOn(v => !v); }
        };
        window.addEventListener("keydown", onKey);
        return () => window.removeEventListener("keydown", onKey);
      }, []);

      const [activeBubble, setActiveBubble] = useState(null);

      return (
        <div className="root">
          <div className="scanlines"></div>
          <div className="vignette"></div>

          <div className="title">
            <motion.span initial={{ opacity: 0, y: -10 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.8 }}>
              Multi
            </motion.span>
          </div>

          <div style={{ position: "absolute", inset: 0 }}>
            {channels.map((c) => (
              <motion.div
                key={c.id}
                className="bubble"
                initial={{ x: 0, y: 0, scale: 0.96, rotate: 0, opacity: 0.95 }}
                animate={{
                  x: [0, 38, -22, 10, 0],
                  y: [0, -26, 32, -14, 0],
                  rotate: [0, 1.8, -2.6, 1, 0],
                  transition: { repeat: Infinity, duration: c.speed, ease: "easeInOut", delay: c.delay },
                }}
                style={{
                  left: `${c.leftPct}%`,
                  top: `${c.topPct}%`,
                  width: c.w,
                  height: c.w * c.hRatio,
                  background:
                    `conic-gradient(from 0deg, hsl(${c.hue} 80% 60% / .22), transparent 35%), ` +
                    `radial-gradient(circle at 30% 20%, hsl(${(c.hue + 80) % 360} 90% 60% / .12), transparent 60%), ` +
                    `var(--tile)`,
                }}
                onClick={() => setActiveBubble(c.id)}
                role="button"
                aria-label={`open-bubble-${c.id}`}
              >
                <div className="bubble-inner">
                  <div className="bubble-shimmer"></div>
                  <div className="bubble-icons">
                    <div className="bubble-icon">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5">
                        <path d="M8 5l8 7-8 7"/>
                      </svg>
                    </div>
                    <div className="bubble-icon">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5">
                        <path d="M6 3l7 18 2-8 8-2-17-8z"/>
                      </svg>
                    </div>
                  </div>
                  <div className="fake-input">
                    <div className="fake-pill">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5">
                        <path d="M4 7h16M4 12h10M4 17h7"/>
                      </svg>
                      <span className="fake-caret"></span>
                    </div>
                  </div>
                </div>
              </motion.div>
            ))}
          </div>

          <AnimatePresence>
            {activeBubble !== null && (
              <motion.div
                key="pad"
                initial={{ opacity: 0 }}
                animate={{ opacity: 1 }}
                exit={{ opacity: 0 }}
                style={{ position:"fixed", inset:0, zIndex:40, display:"flex", alignItems:"center", justifyContent:"center", background:"rgba(0,0,0,.4)", backdropFilter:"blur(4px)" }}
                onClick={() => setActiveBubble(null)}
              >
                <motion.div
                  initial={{ scale: 0.8, opacity: 0 }}
                  animate={{ scale: 1, opacity: 1 }}
                  exit={{ scale: 0.95, opacity: 0 }}
                  transition={{ type: "spring", stiffness: 240, damping: 22 }}
                  style={{ position:"relative", display:"grid", gridTemplateColumns:"repeat(3,1fr)", gap:"16px", borderRadius:"24px", background:"rgba(255,255,255,.05)", padding:"24px", border:"1px solid rgba(255,255,255,.1)" }}
                  onClick={(e) => e.stopPropagation()}
                >
                  {[
                    { key:'prompt', path:"M4 7h16M4 12h10M4 17h7" },
                    { key:'mic', path:"M12 14a3 3 0 0 0 3-3V6a3 3 0 0 0-6 0v5a3 3 0 0 0 3 3zm7-3a7 7 0 0 1-14 0M12 21v-2" },
                    { key:'pin', path:"M8 2l8 8-2 2 4 6-6-4-2 2-8-8 6-6z" },
                    { key:'expand', path:"M3 9V3h6M21 15v6h-6M15 3h6v6M9 21H3v-6" },
                    { key:'spark', path:"M12 2l2 5 5 2-5 2-2 5-2-5-5-2 5-2 2-5z" },
                    { key:'close', path:"M6 6l12 12M18 6l-12 12" },
                  ].map((icon) => (
                    <button key={icon.key} aria-label={icon.key} onClick={() => setActiveBubble(null)} className="btn" style={{ padding:"16px" }}>
                      <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.6"><path d={icon.path} /></svg>
                    </button>
                  ))}
                </motion.div>
              </motion.div>
            )}
          </AnimatePresence>

          <motion.div
            initial={{ scale: 0.8, opacity: 0.6 }}
            animate={{ scale: [0.8, 1.15, 0.9, 1.2, 0.8], opacity: [0.6, 0.35, 0.5, 0.3, 0.6] }}
            transition={{ duration: 6, repeat: Infinity, ease: "easeInOut" }}
            style={{ pointerEvents:"none", position:"absolute", left:"50%", top:"50%", zIndex:10, transform:"translate(-50%,-50%)", width:220, height:220, borderRadius:"999px", boxShadow:"0 0 120px 40px rgba(120,140,255,.12)", background:"radial-gradient(circle at 50% 50%, rgba(160,180,255,.18), rgba(80,90,200,.08) 60%, transparent 70%)" }}
          />

          <div ref={ballEl} className="dot" />

          <AnimatePresence>
            {spotlightOn && (
              <motion.div
                key="spotlight"
                initial={{ opacity: 0 }}
                animate={{ opacity: 1 }}
                exit={{ opacity: 0 }}
                transition={{ duration: 0.5 }}
                style={{
                  pointerEvents:"none", position:"absolute", inset:0, zIndex:20,
                  WebkitMaskImage:`radial-gradient(200px 200px at ${cursor.x}px ${cursor.y}px, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 60%)`,
                  maskImage:`radial-gradient(200px 200px at ${cursor.x}px ${cursor.y}px, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 60%)`,
                  background:"radial-gradient(circle at center, rgba(0,0,0,0), rgba(0,0,0,0.55))",
                  backdropFilter:"blur(2px)"
                }}
              />
            )}
          </AnimatePresence>

          <div className="controls">
            <button className="btn" aria-label="toggle-spotlight" onClick={() => setSpotlightOn(v => !v)}>
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5"><path d="M2 12s4-6 10-6 10 6 10 6-4 6-10 6-10-6-10-6Z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
            <button className="btn" aria-label="reset-dot" onClick={() => { const b = ballRef.current; b.vx = (Math.random()*2 - 1) * 3; b.vy = (Math.random()*2 - 1) * 3; }}>
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5"><path d="M21 12a9 9 0 1 1-2.64-6.36"/><path d="M21 3v6h-6"/></svg>
            </button>
          </div>

          <div className="hint"><span className="ping"></span><span className="dot2"></span></div>
          <div className="baseline"></div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<MultiLanding />);
  </script>
</body>
</html>
